alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"File Type Mismatch: Hidden EXE Content in Non-Executable File"; flow:to_client,established; content:"|4D 5A|"; offset:0; depth:4; flowbits:set,isexe; noalert; classtype:suspicious-filename-detect; sid:1000100; rev:1;)
drop http $EXTERNAL_NET any -> $HOME_NET any (msg:"File Type Mismatch: Hidden EXE Content in Non-Executable File"; flow:to_client,established; file.name; content:!".exe"; nocase; endswith; file.name; content:!".dll"; nocase; endswith; flowbits:isset,isexe; classtype:suspicious-filename-detect; sid:1000101; rev:1;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"File Type Mismatch: Hidden ZIP Archive in File"; flow:to_client,established; content:"|50 4B|"; offset:0; depth:4; flowbits:set,iszip; noalert; classtype:suspicious-filename-detect; sid:1000200; rev:1;)
drop http $EXTERNAL_NET any -> $HOME_NET any (msg:"File Type Mismatch: Hidden ZIP Archive in File"; flow:to_client,established; file.name; content:!".zip"; nocase; endswith; flowbits:isset,iszip; sid:1000201; classtype:suspicious-filename-detect; rev:1;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"File Type Mismatch: Hidden RAR Archive in File"; flow:to_client,established; content:"|52 61 72 21 1A 07|"; offset:0; depth:12; flowbits:set,israr; noalert; classtype:suspicious-filename-detect; sid:1000300; rev:1;)
drop http $EXTERNAL_NET any -> $HOME_NET any (msg:"File Type Mismatch: Hidden RAR Archive in File"; flow:to_client,established; file.name; content:!".rar"; nocase; endswith; flowbits:isset,israr; classtype:suspicious-filename-detect; sid:1000302; rev:1;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"File Type Mismatch: Invalid PNG Magic Bytes with .PNG Extension"; flow:to_client,established; file.name; content:".png"; nocase; endswith; flowbits:set,ispng; noalert; classtype:suspicious-filename-detect; sid:1000400; rev:1;)
drop http $EXTERNAL_NET any -> $HOME_NET any (msg:"File Type Mismatch: Invalid PNG Magic Bytes with .PNG Extension"; flow:to_client,established; content:!"|89 50 4E 47 0D 0A 1A 0A|"; offset:0; depth:16; flowbits:isset,ispng; classtype:suspicious-filename-detect; sid:1000401; rev:1;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"File Type Mismatch: Invalid JPG Magic Bytes with .JPG Extension"; flow:to_client,established; file.name; content:".jpg"; nocase; endswith; flowbits:set,isjpg; noalert; classtype:suspicious-filename-detect; sid:1000500; rev:1;)
drop http $EXTERNAL_NET any -> $HOME_NET any (msg:"File Type Mismatch: Invalid JPG Magic Bytes with .JPG Extension"; flow:to_client,established; content:!"|D8 FF E0|"; offset:0; depth:6; flowbits:isset,isjpg; classtype:suspicious-filename-detect; sid:1000501; rev:1;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"File Type Mismatch: Invalid PDF Magic Bytes with .PDF Extension"; flow:to_client,established; file.name; content:".pdf"; nocase; endswith; flowbits:set,ispdf; noalert; classtype:suspicious-filename-detect; sid:1000600; rev:1;)
drop http $EXTERNAL_NET any -> $HOME_NET any (msg:"File Type Mismatch: Invalid PDF Magic Bytes with .PDF Extension"; flow:to_client,established; content:!"|25 50 44 46 2D|"; offset:0; depth:10; flowbits:isset,ispdf; classtype:suspicious-filename-detect; sid:1000601; rev:1;)
